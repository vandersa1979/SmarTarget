<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="stylesheet" href="../assets/css/fix-smartarget.css">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>RELATORIOS</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .sidebar { scrollbar-width: none; -ms-overflow-style: none; }
        .sidebar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-slate-100 has-sidebar">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-slate-800 text-white flex flex-col p-4 fixed h-full overflow-y-auto sidebar">
            <div class="text-center py-4 mb-5">
                <h1 class="text-2xl font-bold">SmarTarget</h1>
            </div>
            <nav class="flex-grow">
<a href="./home.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🏠 Início</span></a>
<h2 class="text-xs font-semibold text-slate-400 uppercase mt-6 mb-2 px-4">Cadastros</h2>
<a href="./empresas.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🏢 Empresas e Filiais</span></a>
<a href="./departamentos.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>📂 Áreas</span></a>
<a href="./equipes.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>👥 Equipes</span></a>
<a href="./cargos.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>💼 Cargos</span></a>
<a href="./usuarios.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>👤 Usuários</span></a>
<a href="./periodos.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🗓️ Períodos de Avaliação</span></a>
<h2 class="text-xs font-semibold text-slate-400 uppercase mt-6 mb-2 px-4">Gestão de Metas</h2>
<a href="./okrs.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🎯 OKRs</span></a>
<a href="./kpis.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>📊 KPIs</span></a>
<a href="./associacoes.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🔗 Associações</span></a>
<a href="./vinculos.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🔗 Vínculos OKR-KPI</span></a>
<h2 class="text-xs font-semibold text-slate-400 uppercase mt-6 mb-2 px-4">Estratégia</h2>
<a href="./okr-kpi-guia.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>📚 Guia OKR × KPI</span></a>
<a href="./canvas-swot.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🧩 Canvas & SWOT</span></a>
<a href="./bsc.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🧭 BSC</span></a>
<a href="./checkins.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>✅ Check-ins</span></a>
<a href="./acoes-corretivas.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🛠️ Ações Corretivas</span></a>
<a href="./alertas.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🔔 Alertas</span></a>
<a href="./relatorios.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>📑 Relatórios</span></a>
<h2 class="text-xs font-semibold text-slate-400 uppercase mt-6 mb-2 px-4">Análise</h2>
<a href="./mapa-estrategico.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>🗺️ Mapa Estratégico</span></a>
<a href="./dashboard.html" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-slate-700"><span>📈 Dashboard</span></a>
</nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-6 app-main ml-64">
<h1 class="text-2xl font-bold mb-4">Relatórios</h1>
<div class="bg-white p-4 rounded-xl border space-y-4">
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <div>
      <label class="block text-sm font-medium">Tipo</label>
      <select id="rep_tipo" class="input-style w-full mt-1">
        <option value="KPIs">KPIs</option>
        <option value="OKRs">OKRs</option>
        <option value="Checkins">Check-ins</option>
        <option value="Acoes">Ações Corretivas</option>
      </select>
    </div>
    <div class="flex items-end">
      <button id="rep_gerar" class="bg-blue-600 text-white px-4 py-2 rounded-lg w-full">Gerar</button>
    </div>
    <div class="flex items-end">
      <button id="rep_csv" class="bg-slate-700 text-white px-4 py-2 rounded-lg w-full">Exportar CSV</button>
    </div>
  </div>
  <div class="overflow-auto">
    <table class="w-full text-sm mt-4"><thead id="rep_head"></thead><tbody id="rep_body"></tbody></table>
  </div>
</div>
<script>
(function(){
  const head = document.getElementById('rep_head');
  const body = document.getElementById('rep_body');
  let current = {head:[], rows:[]};

  function render(){
    head.innerHTML = '<tr>'+ current.head.map(h=>`<th class="p-2 text-left">${h}</th>`).join('') +'</tr>';
    body.innerHTML = current.rows.map(r=> '<tr class="border-b">'+ r.map(c=>`<td class="p-2">${c}</td>`).join('') +'</tr>' ).join('');
  }

  document.getElementById('rep_gerar').onclick=function(){
    const t = document.getElementById('rep_tipo').value;
    if (t==='KPIs'){
      const k = JSON.parse(localStorage.getItem('kpis')||'[]');
      current.head = ['KPI','Tipo','Alvo','Realizado','OKR (Pai)','Responsável'];
      current.rows = k.map(x=>[x.nome,x.tipo,x.valorAlvo||0,x.valorRealizado||0,x.okrPai||'',x.responsavelApuracao||'']);
    } else if (t==='OKRs'){
      const o = JSON.parse(localStorage.getItem('okrs')||'[]');
      current.head = ['Objetivo','Pilar','Prioridade','Status','% Andamento','Responsável','Período'];
      current.rows = o.map(x=>[x.objetivo,x.pilar||'',x.prioridade||'',x.status||'',x.andamento||0,x.responsavel||'',x.periodo||'']);
    } else if (t==='Checkins'){
      const c = JSON.parse(localStorage.getItem('checkins')||'[]');
      current.head = ['Tipo','Item','Data','%','Notas'];
      current.rows = c.map(x=>[x.tipo,x.item,x.data,x.pct,x.notas]);
    } else {
      const a = JSON.parse(localStorage.getItem('acoesCorretivas')||'[]');
      current.head = ['Título','Relacionado','Prazo','Status','Responsável','Descrição'];
      current.rows = a.map(x=>[x.titulo, x.tipo+': '+x.item, x.prazo||'', x.status||'', x.resp||'', x.desc||'']);
    }
    render();
  };

  document.getElementById('rep_csv').onclick=function(){
    if (!current.rows.length){ alert('Gere um relatório primeiro.'); return; }
    const csv = [current.head.join(';')].concat(current.rows.map(r=> r.map(c=>(''+c).replaceAll(';',',')).join(';'))).join('
');
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'relatorio.csv'; a.click();
    URL.revokeObjectURL(url);
  };
})();
</script>
</main>
    </div>
</body>
</html>
